/*! pimpmylog - 1.0.5 - 304e44fae52b81256e7624dbca2a9cb3d005808e*/
/*
 * pimpmylog
 * http://pimpmylog.com
 *
 * Copyright (c) 2014 Potsky, contributors
 * Licensed under the GPLv3 license.
 */var progressbar_active=function(){"use strict";$(".progress").addClass("progress-striped active")},progressbar_deactive=function(){"use strict";$(".progress").removeClass("progress-striped active")},progressbar_set=function(a){"use strict";var b=Math.max(0,Math.min(100,parseInt(a,10)));$(".progress .sr-only").text(lemma.complete.replace("%s",b)),$(".progress-bar").prop("aria-valuenow",b).width(b+"%")},progressbar_color=function(a){"use strict";$(".progress-bar").removeClass("progress-bar-success progress-bar-info progress-bar-warning progress-bar-success progress-bar-danger"),void 0!==a&&$(".progress-bar").addClass("progress-bar-"+a)},fatal_error=function(a){"use strict";a||(a=lemma.error),progressbar_color("danger"),progressbar_set(100),$('<div class="alert alert-danger fade in">'+a+"</div>").appendTo("#error"),$("#user").text(""),$("#reload").hide(),$("#next").hide()},pml_action=function(a,b,c){"use strict";progressbar_active(),$.ajax({url:"configure.php?"+(new Date).getTime()+"&"+querystring,data:a,type:"POST",dataType:"json"}).fail(function(a,b,c){progressbar_color("danger"),progressbar_set(100),$('<div class="alert alert-danger fade in">'+c.message+"</div>").appendTo("#error")}).done(function(a){a.error?fatal_error(a.error):b(a,c)}).always(function(a){a.reload?$("#reload").show():$("#reload").hide(),a.next?$("#next").show():$("#next").hide().unbind("click"),progressbar_deactive()})},action_configue_now=function(a){"use strict";$("#error").text(""),$("#user").text(""),$(".alert").remove(),progressbar_set(80),pml_action({s:"configure",l:a},function(){progressbar_set(100),progressbar_color("success"),$("#congratulations").show(),$("#error").hide(),$("#user").hide(),$("#buttons").hide()})},logs_list=[],action_select_logs=function(a){"use strict";var b=a.a,c=a.b,d=a.c,e=40,f=60,g=parseInt(e+(d-c.length)/d*(f-e),10);if(progressbar_set(g),0===c.length)return action_configue_now(logs_list),void 0;var h=c.shift();pml_action({s:"find",so:h},function(a){$("#user").html(a.notice);var e="";0===a.found?progressbar_color("danger"):1===a.found?progressbar_color("warning"):(progressbar_color(),e='style="display:none;"'),$("#find").addClass("table table-striped table-bordered table-hover table-condensed").append('<thead><tr><th><input type="checkbox" id="all"></th><th>'+lemma.path+"</th><th>"+lemma.file+"</th><th>"+lemma.type+"</th><th>"+lemma.readable+"</th></tr></thead><tbody></tbody>");for(var f in a.files)for(var g in a.files[f])if(a.files[f][g]===!0)$("#find tbody").append("<tr "+e+"><td></td><td>"+g+'</td><td></td><td></td><td><span class="label label-success">'+lemma.yes+"</span></td></tr>");else if(a.files[f][g]===!1)$("#find tbody").append("<tr "+e+"><td></td><td>"+g+'</td><td></td><td></td><td><span class="label label-danger">'+lemma.no+"</span></td></tr>");else for(var h in a.files[f][g])for(var i in a.files[f][g][h]){var j=a.files[f][g][h][i];$("<tr>").data("file",{s:f,f:g+j,t:h}).html('<td><input type="checkbox"></td><td>'+g+"</td><td>"+j+"</td><td>"+h+'</td><td><span class="label label-success">'+lemma.yes+"</span></td>").appendTo("#find tbody")}$("#find tbody tr").click(function(){$(this).find('input[type="checkbox"]').click()}),$('#find tbody tr input[type="checkbox"]').click(function(a){a.stopPropagation();var b=$(this).prop("checked");b?$(this).parents("tr").addClass("success"):$(this).parents("tr").removeClass("success")}),$("#find #all").click(function(){var a=$(this).prop("checked");$("#find tbody tr").each(function(){var b=$(this).find('input[type="checkbox"]');1===b.length&&($(b).prop("checked",a),a?$(this).addClass("success"):$(this).removeClass("success"))})}),$("#find #all").click(),$("#next").unbind("click").click(function(){var a=!1,e=[];return $(".userpaths").each(function(){var a=$.trim($(this).val()).split(/[\n,]+/);if(a.length>0)for(var b in a){var c=$.trim(a[b]);""!==c&&e.push({s:$(this).data("soft"),t:$(this).data("type"),f:c})}}),e.length>0?(pml_action({s:"check",uf:e},function(a){a.notice?$(".alert").removeClass("alert-success").addClass("alert-warning").html(a.notice):($("#error").text(""),$(".alert").remove(),$('#find tbody tr input[type="checkbox"]:checked').each(function(){logs_list.push($(this).parents("tr").data("file"))}),logs_list=$.merge(logs_list,a.found),action_select_logs({a:b,b:c,c:d}))}),void 0):($('#find tbody tr input[type="checkbox"]:checked').each(function(){logs_list.push($(this).parents("tr").data("file")),a=!0}),a===!0?($("#error").text(""),$(".alert").remove(),action_select_logs({a:b,b:c,c:d})):$(".alert").removeClass("alert-success").addClass("alert-warning").html(lemma.chooselog),void 0)})})},clipboard_enable=function(a,b,c,d){$(a).zclip({path:"../js/ZeroClipboard.swf",copy:function(){return $(b).text()},afterCopy:function(){$(a).popover({html:!0,animation:!0,placement:c,container:"body",delay:{show:100,hide:5e3},content:d}).popover("show"),$(a).on("hidden.bs.popover",function(){$(a).show()})}})};$(function(){"use strict";$(".logo").click(function(){location.reload()}),progressbar_set(10),pml_action({s:"exist"},function(){progressbar_set(20),pml_action({s:"touch"},function(a){a.notice?($("#user").html(a.notice),progressbar_color("warning")):($("#user").html(lemma.pleasewait),progressbar_set(30),pml_action({s:"soft"},function(a){if(a.sofn>0){var b=[];if(a.sofn>1){$("#user").html(a.notice),$("#soft").addClass("table table-striped table-bordered table-hover table-condensed").append('<thead><tr><th><input type="checkbox" id="all"></th><th>'+lemma.name+"</th><th>"+lemma.description+"</th><th>"+lemma.notes+"</th></tr></thead><tbody></tbody>");for(var c in a.soft){var d=a.soft[c].home,e=void 0===d||""===d?a.soft[c].name:'<a href="'+d+'" target="doc">'+a.soft[c].name+"</a>";$("<tr>").data("softid",c).data("load",a.soft[c].load).html('<td><input type="checkbox"></td><td>'+e+"</td><td>"+a.soft[c].desc+"</td><td>"+a.soft[c].notes+"</td>").appendTo("#soft tbody")}$("#soft tbody tr").click(function(){$(this).find('input[type="checkbox"]').click()}),$('#soft tbody tr input[type="checkbox"]').click(function(a){a.stopPropagation();var b=$(this).prop("checked");b?$(this).parents("tr").addClass("success"):$(this).parents("tr").removeClass("success")}),$('#soft tbody tr input[type="checkbox"]').each(function(){$(this).parents("tr").data("load")&&($(this).prop("checked",!0),$(this).parents("tr").addClass("success"))}),$("#soft #all").click(function(){var a=$(this).prop("checked");$("#soft tbody tr").each(function(){var b=$(this).find('input[type="checkbox"]');$(b).prop("checked",a),a?$(this).addClass("success"):$(this).removeClass("success")})}),$("#next").unbind("click").click(function(){$('#soft tbody tr input[type="checkbox"]:checked').each(function(){b.push($(this).parents("tr").data("softid"))}),b.length>0?($("#error").text(""),action_select_logs({a:a.soft,b:b,c:b.length})):$('<div class="alert alert-warning fade in">'+lemma.choosesoftware+"</div>").appendTo("#error")})}else{for(var f in a.soft)b.push(f);action_select_logs({a:a.soft,b:b,c:b.length})}}else fatal_error()}))})})});